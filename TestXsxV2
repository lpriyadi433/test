["invisfling"] = {
    Prefix = ";",
    Commands = {"invisfling"},
    Description = "Toggle invisibility and fling effect",
    Fun = true,
    AdminLevel = "Admins",
    Function = function(plr, args)
        local character = plr.Character
        if not character then return end

        -- marker untuk status toggle
        local toggled = character:FindFirstChild("InvisFlingToggled")
        local isOn = toggled and toggled.Value

        if isOn then
            -- turn off: buat karakter terlihat kembali
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Transparency = 0
                    if part:FindFirstChild("Decal") then
                        part.Decal.Transparency = 0
                    end
                elseif part:IsA("Accessory") and part:FindFirstChild("Handle") then
                    part.Handle.Transparency = 0
                end
            end

            -- putuskan koneksi fling
            local hrp = character:FindFirstChild("HumanoidRootPart")
            if hrp and hrp:FindFirstChild("InvisFlingConnection") then
                hrp.InvisFlingConnection.Value:Disconnect()
                hrp.InvisFlingConnection:Destroy()
            end

            if toggled then toggled:Destroy() end
            plr:SendNotification({Title="InvisFling", Text="Effect OFF"})
        else
            -- turn on: buat karakter invisible dan aktifkan fling
            local hrp = character:FindFirstChild("HumanoidRootPart")
            if not hrp then return end

            -- invisible
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Transparency = 1
                    if part:FindFirstChild("Decal") then
                        part.Decal.Transparency = 1
                    end
                elseif part:IsA("Accessory") and part:FindFirstChild("Handle") then
                    part.Handle.Transparency = 1
                end
            end

            -- fling connection
            if hrp:FindFirstChild("InvisFlingConnection") then
                hrp.InvisFlingConnection.Value:Disconnect()
                hrp.InvisFlingConnection:Destroy()
            end

            local conn
            conn = hrp.Touched:Connect(function(hit)
                local otherHumanoid = hit.Parent:FindFirstChild("Humanoid")
                if otherHumanoid and hit.Parent ~= character then
                    local otherHRP = hit.Parent:FindFirstChild("HumanoidRootPart")
                    if otherHRP then
                        local bodyVelocity = Instance.new("BodyVelocity")
                        bodyVelocity.Velocity = Vector3.new(0,50,0)
                        bodyVelocity.MaxForce = Vector3.new(1e5,1e5,1e5)
                        bodyVelocity.Parent = otherHRP
                        game:GetService("Debris"):AddItem(bodyVelocity, 0.5)
                    end
                end
            end)

            -- simpan koneksi dan status toggle
            local markerConn = Instance.new("ObjectValue")
            markerConn.Name = "InvisFlingConnection"
            markerConn.Value = conn
            markerConn.Parent = hrp

            local markerToggle = Instance.new("BoolValue")
            markerToggle.Name = "InvisFlingToggled"
            markerToggle.Value = true
            markerToggle.Parent = character

            plr:SendNotification({Title="InvisFling", Text="Effect ON"})
        end
    end
}
